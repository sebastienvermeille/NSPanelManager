"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5392],{1733:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>h,default:()=>m,frontMatter:()=>d,metadata:()=>r,toc:()=>p});const r=JSON.parse('{"id":"getting-started/flash-nspanel","title":"Flash Sonoff NSPanel","description":"Video guide through","source":"@site/docs/getting-started/flash-nspanel.md","sourceDirName":"getting-started","slug":"/getting-started/flash-nspanel","permalink":"/docs/getting-started/flash-nspanel","draft":false,"unlisted":false,"editUrl":"https://github.com/NSPManager/NSPanelManager/docs/edit/beta/docs/getting-started/flash-nspanel.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Flash Sonoff NSPanel","sidebar_position":4},"sidebar":"mainSidebar","previous":{"title":"Supported devices","permalink":"/docs/getting-started/supported-devices"},"next":{"title":"Home Assistant Add-on","permalink":"/docs/getting-started/install/installation-guide-home-assistant"}}');var a=n(4848),s=n(8453),l=n(655),o=n(3228),i=n(1470),c=n(9365);const d={title:"Flash Sonoff NSPanel",sidebar_position:4},h="Flash Sonoff NSPanel",u={},p=[{value:"Video guide through",id:"video-guide-through",level:2},{value:"Detailed guide",id:"detailed-guide",level:2},{value:"NSPanel disassembly",id:"nspanel-disassembly",level:3},{value:"Detach the Power block",id:"detach-the-power-block",level:4},{value:"Remove plastic cover from Screen enclosure",id:"remove-plastic-cover-from-screen-enclosure",level:4},{value:"Detach the screen from the PCB",id:"detach-the-screen-from-the-pcb",level:4},{value:"Prepare for flashing",id:"prepare-for-flashing",level:4},{value:"Connect your USB to UART (TTL) converter",id:"connect-your-usb-to-uart-ttl-converter",level:3},{value:"Flash NSPanel with NSPanelManager custom firmware",id:"flash-nspanel-with-nspanelmanager-custom-firmware",level:3}];function f(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"flash-sonoff-nspanel",children:"Flash Sonoff NSPanel"})}),"\n",(0,a.jsx)(t.h2,{id:"video-guide-through",children:"Video guide through"}),"\n",(0,a.jsxs)(t.admonition,{type:"note",children:[(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"Only the first 3 chapters of the video are relevant here"}),". Do not flash it with ESPHome, this is another firmware that will not work with NSPanelManager."]}),(0,a.jsxs)(t.p,{children:["Instead, follow the below documentation to learn how to ",(0,a.jsx)(t.a,{href:"#flash-nspanel-with-nspanelmanager-custom-firmware",children:"flash the NSPanelManager firmware on your NSPanel"}),"."]})]}),"\n",(0,a.jsx)(l.A,{videoId:"p-AK4o5jOSI",author:"Mark Watt Tech",description:"Flash Sonoff NSPanel with ESPHome"}),"\n",(0,a.jsx)(t.h2,{id:"detailed-guide",children:"Detailed guide"}),"\n",(0,a.jsx)(t.h3,{id:"nspanel-disassembly",children:"NSPanel disassembly"}),"\n",(0,a.jsx)(t.h4,{id:"detach-the-power-block",children:"Detach the Power block"}),"\n",(0,a.jsx)(t.admonition,{type:"danger",children:(0,a.jsx)(t.p,{children:"Make sure to orient the NSPanel the same way as on the picture\nIt has to be oriented so you can read the text naturally. Doing it this way reduce the risk to hurt the bottom diode."})}),"\n",(0,a.jsx)(o.A,{src:"/images/doc/flash/step1.png",alt:"Detach power block",figureNumber:"1"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:"Place flat screw driver behind this little metal part and lift it up"}),"\n",(0,a.jsx)(t.li,{children:"Same as previously"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"Do it softly until you are able to separate the Power block from the rest of the NSPanel."}),"\n",(0,a.jsx)(t.p,{children:"You should end up with two parts:"}),"\n",(0,a.jsx)(o.A,{src:"/images/doc/flash/step1-output.png",alt:"The detached Power block from the Screen enclosure",figureNumber:"2"}),"\n",(0,a.jsx)(t.h4,{id:"remove-plastic-cover-from-screen-enclosure",children:"Remove plastic cover from Screen enclosure"}),"\n",(0,a.jsx)(o.A,{src:"/images/doc/flash/step2.png",alt:"The plastic cover attached to the case",figureNumber:"3"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:"Unscrew it with a cross screwdriver"}),"\n",(0,a.jsx)(t.li,{children:"Unscrew it with a cross screwdriver"}),"\n",(0,a.jsx)(t.li,{children:"After than you can detach the plastic cover from the PCB"}),"\n"]}),"\n",(0,a.jsx)(t.h4,{id:"detach-the-screen-from-the-pcb",children:"Detach the screen from the PCB"}),"\n",(0,a.jsx)(t.admonition,{type:"danger",children:(0,a.jsx)(t.p,{children:"This operation has to be done very smoothly."})}),"\n",(0,a.jsx)(o.A,{src:"/images/doc/flash/step3.png",alt:"The PCB connected to the screen via FFC cable",figureNumber:"4"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:"Push slightly from left to right the black part of the connector (2mm)"}),"\n",(0,a.jsx)(t.li,{children:"same as point 1."}),"\n",(0,a.jsx)(t.li,{children:"Point 1 and 2 unlocked the FFC cable, it can now be slowly taken out from the connector."}),"\n"]}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsx)(t.p,{children:"The black part of the FFC cable do not contains any electronic nor conductive feature, you can catch it with tweezers without fear to damage it."})}),"\n",(0,a.jsx)(t.h4,{id:"prepare-for-flashing",children:"Prepare for flashing"}),"\n",(0,a.jsxs)(t.p,{children:["In order to get the ESP32 enter in flash mode, ",(0,a.jsx)(t.code,{children:"GPIO0"}),", noted ",(0,a.jsx)(t.code,{children:"IO0"})," on the PCB has to be connected to ",(0,a.jsx)(t.code,{children:"GND"}),":"]}),"\n",(0,a.jsx)(o.A,{src:"/images/doc/flash/step4.png",alt:"The PCB connected to the screen via FFC cable",figureNumber:"5"}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["Connect (or solder temporarily) a cable between ",(0,a.jsx)(t.code,{children:"IO0"})," and ",(0,a.jsx)(t.code,{children:"GND"})," (2)."]}),"\n"]}),"\n",(0,a.jsxs)(t.admonition,{type:"info",children:[(0,a.jsxs)(t.p,{children:["Here is the pinout documented by Blackadder more in details ",(0,a.jsx)(t.a,{href:"https://blakadder.com/nspanel-teardown/",children:"here"}),":"]}),(0,a.jsx)(o.A,{src:"/images/doc/flash/step4-pinout.png",alt:"NSPanel pinout",figureNumber:"6"})]}),"\n",(0,a.jsx)(t.h3,{id:"connect-your-usb-to-uart-ttl-converter",children:"Connect your USB to UART (TTL) converter"}),"\n",(0,a.jsx)(t.admonition,{type:"danger",children:(0,a.jsx)(t.p,{children:"Make sure to use the 3v3 (not 5V), this can generally be configured with a Jumper up on the USB to UART converter."})}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:"Connect the USB to UART convert to the PCB:"}),"\n"]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"USB-UART PIN"}),(0,a.jsx)(t.th,{children:"NSPanel PCB PIN"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"VCC"}),(0,a.jsx)(t.td,{children:"VCC (Symbolized by a square on the PCB)"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"RX"}),(0,a.jsx)(t.td,{children:"TX"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"TX"}),(0,a.jsx)(t.td,{children:"RX"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"GND"}),(0,a.jsx)(t.td,{children:"GND"})]})]})]}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsx)(t.p,{children:"Notice that RX and TX pins have to be inverted between the devices: it is not TX -> TX, RX -> RX (See upper table)."})}),"\n",(0,a.jsx)(t.h3,{id:"flash-nspanel-with-nspanelmanager-custom-firmware",children:"Flash NSPanel with NSPanelManager custom firmware"}),"\n",(0,a.jsxs)(t.p,{children:["First, download the latest firmware ",(0,a.jsx)(t.code,{children:"merged-flash.bin"})," from ",(0,a.jsx)(t.a,{href:"https://github.com/NSPManager/NSPanelManager/raw/refs/heads/main/firmware/NSPanelManagerFirmware/merged-flash.bin",children:"here"}),"."]}),"\n",(0,a.jsx)(t.p,{children:"Then, flash the firmware with your tool of choice:"}),"\n",(0,a.jsxs)(i.A,{groupId:"flashing-tool",queryString:!0,children:[(0,a.jsx)(c.A,{value:"Espressif",label:"Espressif tool (Windows)",children:(0,a.jsxs)(t.ol,{start:"2",children:["\n",(0,a.jsxs)(t.li,{children:["\n",(0,a.jsxs)(t.p,{children:["Download Espressif tool from here: ",(0,a.jsx)(t.a,{href:"https://www.espressif.com/en/support/download/other-tools",children:"https://www.espressif.com/en/support/download/other-tools"}),"\n3. Open the tool and choose to flash an ",(0,a.jsx)(t.code,{children:"ESP32 chip"}),".\n4. Click on the ",(0,a.jsx)(t.code,{children:"..."})," button and select the firmware you downloaded at step 1 called ",(0,a.jsx)(t.code,{children:"merged-flash.bin"}),".\n5. enter ",(0,a.jsx)(t.code,{children:"0x0"})," as the upload address.\n6. Check the first checkbox next to the firmware file\n7. Click the ",(0,a.jsx)(t.code,{children:"START"})," button and wait until it writes ",(0,a.jsx)(t.code,{children:"FINISH"}),"."]}),"\n",(0,a.jsx)(o.A,{src:"/images//doc/esp_flash_download_tool.png"}),"\n"]}),"\n"]})}),(0,a.jsxs)(c.A,{value:"esptool",label:"ESPtool",children:[(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:"Open a terminal."}),"\n",(0,a.jsxs)(t.li,{children:["Navigate to the directory where you saved the ",(0,a.jsx)(t.code,{children:"merged_flash.bin"}),"-file."]}),"\n",(0,a.jsxs)(t.li,{children:["To determine if you have selected the right port, run ",(0,a.jsx)(t.code,{children:"esptool.py flash_id --port <port>"}),".\nYou will have to replace ",(0,a.jsx)(t.code,{children:"<port>"})," with the actual port connected to the NSPanel.\nThis will do a check and see if the tool can communicate with the NSPanel."]}),"\n",(0,a.jsxs)(t.li,{children:["Run ",(0,a.jsx)(t.code,{children:"esptool.py --baud 921600 --port /dev/ttyUSB0 write_flash 0x0 merged_flash.bin"}),".\nYou will have to replace ",(0,a.jsx)(t.code,{children:"/dev/ttyUSB0"})," with the actual port connected to the NSPanel."]}),"\n"]}),(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["On Windows it might be just ",(0,a.jsx)(t.code,{children:"esptool"})," without the ",(0,a.jsx)(t.code,{children:".py"})," at the end."]})}),(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["On Windows ",(0,a.jsx)(t.code,{children:"/dev/ttyUSB0"})," will have to be replaced by something like ",(0,a.jsx)(t.code,{children:"COM4"}),". If using MacOS or Linux the\nport will be something similar to ",(0,a.jsx)(t.code,{children:"/dev/ttyUSB0"}),"."]})})]})]})]})}function m(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(f,{...e})}):f(e)}},9365:(e,t,n)=>{n.d(t,{A:()=>l});n(6540);var r=n(4164);const a={tabItem:"tabItem_Ymn6"};var s=n(4848);function l(e){let{children:t,hidden:n,className:l}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(a.tabItem,l),hidden:n,children:t})}},1470:(e,t,n)=>{n.d(t,{A:()=>y});var r=n(6540),a=n(4164),s=n(3104),l=n(6347),o=n(205),i=n(7485),c=n(1682),d=n(679);function h(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??function(e){return h(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:a}}=e;return{value:t,label:n,attributes:r,default:a}}))}(n);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function f(e){let{queryString:t=!1,groupId:n}=e;const a=(0,l.W6)(),s=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,i.aZ)(s),(0,r.useCallback)((e=>{if(!s)return;const t=new URLSearchParams(a.location.search);t.set(s,e),a.replace({...a.location,search:t.toString()})}),[s,a])]}function m(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,s=u(e),[l,i]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:s}))),[c,h]=f({queryString:n,groupId:a}),[m,x]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,s]=(0,d.Dv)(n);return[a,(0,r.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:a}),g=(()=>{const e=c??m;return p({value:e,tabValues:s})?e:null})();(0,o.A)((()=>{g&&i(g)}),[g]);return{selectedValue:l,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);i(e),h(e),x(e)}),[h,x,s]),tabValues:s}}var x=n(2303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=n(4848);function j(e){let{className:t,block:n,selectedValue:r,selectValue:l,tabValues:o}=e;const i=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),d=e=>{const t=e.currentTarget,n=i.indexOf(t),a=o[n].value;a!==r&&(c(t),l(a))},h=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=i.indexOf(e.currentTarget)+1;t=i[n]??i[0];break}case"ArrowLeft":{const n=i.indexOf(e.currentTarget)-1;t=i[n]??i[i.length-1];break}}t?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":n},t),children:o.map((e=>{let{value:t,label:n,attributes:s}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,ref:e=>i.push(e),onKeyDown:h,onClick:d,...s,className:(0,a.A)("tabs__item",g.tabItem,s?.className,{"tabs__item--active":r===t}),children:n??t},t)}))})}function v(e){let{lazy:t,children:n,selectedValue:s}=e;const l=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=l.find((e=>e.props.value===s));return e?(0,r.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:l.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==s})))})}function w(e){const t=m(e);return(0,b.jsxs)("div",{className:(0,a.A)("tabs-container",g.tabList),children:[(0,b.jsx)(j,{...t,...e}),(0,b.jsx)(v,{...t,...e})]})}function y(e){const t=(0,x.A)();return(0,b.jsx)(w,{...e,children:h(e.children)},String(t))}},3228:(e,t,n)=>{n.d(t,{A:()=>l});n(6540);const r="centeredImageContainer_LZL8",a="caption_TNGg";var s=n(4848);const l=e=>{let{src:t,alt:n,width:l="auto",height:o="auto",figureNumber:i}=e;return(0,s.jsxs)("figure",{className:r,children:[(0,s.jsx)("img",{src:t,alt:n,style:{width:l,height:o}}),i&&(0,s.jsxs)("figcaption",{className:a,children:["Figure ",i,": ",n]})]})}},655:(e,t,n)=>{n.d(t,{A:()=>a});n(6540);var r=n(4848);const a=e=>{let{videoId:t,author:n,description:a,aspectRatio:s="56.25%"}=e;return(0,r.jsxs)("div",{style:{margin:"20px 0"},children:[(0,r.jsx)("div",{style:{position:"relative",paddingBottom:s,height:0},children:(0,r.jsx)("iframe",{src:`https://www.youtube.com/embed/${t}`,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},title:"YouTube video player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),(0,r.jsxs)("div",{style:{textAlign:"center",marginTop:"10px",fontSize:"0.9rem"},children:[n&&(0,r.jsxs)("p",{style:{fontStyle:"italic",margin:"5px 0"},children:["By: ",n]}),a&&(0,r.jsx)("p",{style:{margin:"5px 0",color:"#555"},children:a})]})]})}}}]);